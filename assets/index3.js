import{_ as Y,g as se,a as te,b as ge}from"./index.js";import{d as D,i as F,r as g,C as z,o as E,M as L,e as r,b as f,P as H,Q as x,u as $,v as P,f as I,F as le,R as j,a5 as ye,J as ee,ax as $e,ay as re,c as J,az as G,af as be,a as A,x as R,S as K,ag as ie,T as ae,N as q,O as de,ae as ce,aA as Ne,aB as Ee,aC as Ce,aD as we,aE as ke,aF as Te,aG as Pe,D as Oe,aH as Se,aI as ue,I as Le,w as Q,aJ as U,a6 as pe,a7 as fe,aK as De,aL as Ie,aM as Be,q as me,aN as _e,aO as Me,g as Ae}from"./vendor.js";import{u as Re,a as Ue}from"./data.js";const Fe={class:"add-but"},Ve=D({__name:"Add",emits:["addNode"],setup(u,{emit:p}){const{readOnly:i}=F("flowDesign",{readOnly:g(!1)}),n=g(),e=p,o=t=>{var s;e("addNode",t),(s=n.value)==null||s.hide()};return(t,s)=>{const d=z("Stamp"),c=le,_=j,b=z("Promotion"),C=z("Share"),w=z("Timer"),S=z("BellFilled"),v=ye,k=ee,B=$e;return E(),L("div",Fe,[r(B,{placement:"bottom-start",ref_key:"popoverRef",ref:n,trigger:"click",title:"添加节点",width:336},{reference:f(()=>[H(r(k,{icon:"Plus",type:"primary",style:{"z-index":"1"},circle:""},null,512),[[x,!$(i)]])]),default:f(()=>[r(v,{wrap:""},{default:f(()=>[P("div",{class:"node-select",onClick:s[0]||(s[0]=()=>o("approval"))},[r(c,null,{default:f(()=>[r(d,{class:"Stamp"})]),_:1}),r(_,null,{default:f(()=>[I("审批人")]),_:1})]),P("div",{class:"node-select",onClick:s[1]||(s[1]=()=>o("cc"))},[r(c,null,{default:f(()=>[r(b,{class:"Promotion"})]),_:1}),r(_,null,{default:f(()=>[I("抄送人")]),_:1})]),P("div",{class:"node-select",onClick:s[2]||(s[2]=()=>o("exclusive"))},[r(c,null,{default:f(()=>[r(C,{class:"Share"})]),_:1}),r(_,null,{default:f(()=>[I("互斥分支")]),_:1})]),P("div",{class:"node-select",onClick:s[3]||(s[3]=()=>o("timer"))},[r(c,null,{default:f(()=>[r(w,{class:"Timer"})]),_:1}),r(_,null,{default:f(()=>[I("计时等待")]),_:1})]),P("div",{class:"node-select",onClick:s[4]||(s[4]=()=>o("notify"))},[r(c,null,{default:f(()=>[r(S,{class:"BellFilled"})]),_:1}),r(_,null,{default:f(()=>[I("消息通知")]),_:1})])]),_:1})]),_:1},512)])}}}),ve=Y(Ve,[["__scopeId","data-v-e581b562"]]),je={class:"node-box"},ze={class:"head"},We=D({__name:"Node",props:{icon:{},node:{},color:{},readOnly:{type:Boolean,default:!1},close:{type:Boolean,default:!0}},emits:["addNode","delNode","activeNode"],setup(u,{emit:p}){re(v=>({"93693f22":v.color}));const i={List:Ne,Timer:Ee,BellFilled:Ce,Share:we,Promotion:ke,Stamp:Te},n=F("flowDesign",{readOnly:g(!1),nodesError:g({})}),e=p,o=u,t=J(()=>n.nodesError.value[o.node.id]),s=J(()=>{var v;return((v=n.readOnly)==null?void 0:v.value)||o.readOnly}),d=g(!1),c=g(),_=()=>{s.value||(d.value=!0,Pe(()=>{var v;(v=c.value)==null||v.focus()}))},b=()=>{d.value&&(d.value=!1)},C=()=>{s.value||e("activeNode",o.node)},w=v=>{e("addNode",v,o.node)},S=()=>{e("delNode",o.node)};return(v,k)=>{var a;const B=Oe,O=z("EditPen"),y=le,N=j,T=ee,V=Se,X=z("WarnTriangleFilled"),ne=ue,l=Le;return E(),L("div",je,[r(l,{onClick:C,class:ce(["node",{"error-node":((a=$(t))==null?void 0:a.length)&&!$(s)}])},{header:f(()=>[P("div",ze,[$(d)?(E(),L("div",{key:0,onClick:k[1]||(k[1]=G(()=>{},["stop"]))},[H(r(B,{ref_key:"inputRef",ref:c,onBlur:b,maxlength:"30",modelValue:v.node.name,"onUpdate:modelValue":k[0]||(k[0]=m=>v.node.name=m)},null,8,["modelValue"]),[[$(be),b]])])):(E(),A(N,{key:1,tag:"b",truncated:"",onClick:G(_,["stop"])},{default:f(()=>[I(R(v.node.name)+" ",1),r(y,null,{default:f(()=>[r(O)]),_:1})]),_:1})),K(v.$slots,"icon",{},()=>[v.icon?(E(),A(y,{key:0,size:30,color:"node-icon"},{default:f(()=>[(E(),A(ie(i[v.icon])))]),_:1})):ae("",!0)],!0)]),P("span",{onClick:k[2]||(k[2]=G(()=>{},["stop"]))},[r(V,{title:"您确定要删除该节点吗？",width:"200","hide-after":0,placement:"right-start",onConfirm:S},{reference:f(()=>[H(r(T,{class:"node-close",plain:"",circle:"",icon:"CircleClose",size:"small",type:"danger"},null,512),[[x,v.close&&!$(s)]])]),_:1})]),r(ne,{placement:"top-start"},{content:f(()=>[(E(!0),L(q,null,de($(t),m=>(E(),L("div",{key:m.id},R(m.message),1))),128))]),default:f(()=>{var m;return[H(r(y,{class:"warn-icon",size:20},{default:f(()=>[r(X,{onClick:k[3]||(k[3]=G(()=>{},["stop"]))})]),_:1},512),[[x,((m=$(t))==null?void 0:m.length)&&!$(s)]])]}),_:1})]),default:f(()=>[K(v.$slots,"default",{},void 0,!0)]),_:3},8,["class"]),r(ve,{onAddNode:w})])}}}),Z=Y(We,[["__scopeId","data-v-64cc1d9f"]]),Ye={class:"start-node"},Xe=D({__name:"StartNode",props:{node:{}},setup(u){const p=u,{nodesError:i}=F("flowDesign",{nodesError:g({})});return Q(()=>{const n=[],{id:e,name:o,child:t}=p.node;(t==null?void 0:t.type)==="end"&&n.push({id:e,name:o,message:"发起下节点为空"}),n.length>0?i.value[e]=n:delete i.value[e]}),(n,e)=>{const o=j;return E(),L("div",Ye,[r(Z,U(n.$attrs,{icon:"List",close:!1,color:"#8c7cf3",node:n.node}),{default:f(()=>[r(o,null,{default:f(()=>[I(R(n.$t("flow.start.default")),1)]),_:1})]),_:1},16,["node"])])}}}),Ge=Y(Xe,[["__scopeId","data-v-ee05aea0"]]),qe=D({__name:"ApprovalNode",props:{node:{}},setup(u){const{nodesError:p}=F("flowDesign",{fields:g([]),nodesError:g({})}),i=u,n=g("");return Q(()=>{var B,O;const e=[],{id:o,name:t,assigneeType:s,nobody:d,nobodyUsers:c,choice:_,formUser:b,formRole:C,leader:w,orgLeader:S,users:v,roles:k}=i.node;if(s==="user")if(v.length>0){const y=v.map(N=>se(N));Promise.all(y).then(N=>{n.value=N.map(T=>T.data.name).join("、")})}else e.push({id:o,name:t,message:"未指定人员"}),n.value="未指定人员";else if(s==="choice")n.value=`发起人自选（${_?"多选":"单选"}）`;else if(s==="self")n.value="发起人自己";else if(s==="leader")n.value=w===1?"直属上级":`${w}级上级`;else if(s==="orgLeader")n.value=S===1?"直属主管":`${S}级主管`;else if(s==="formUser"){b||e.push({id:o,name:t,message:"未指定表单内人员"});const y=((B=fields.value.find(N=>N.id===b))==null?void 0:B.label)||b||"?";n.value=`表单内（${y}）人员`}else if(s==="formRole"){C||e.push({id:o,name:t,message:"未指定表单内角色"});const y=((O=fields.value.find(N=>N.id===C))==null?void 0:O.label)||C||"?";n.value=`表单内（${y}）角色`}else if(s==="role")if(k.length>0){const y=k.map(N=>te(N));Promise.all(y).then(N=>{n.value=N.map(T=>T.data.name).join("、")})}else e.push({id:o,name:t,message:"未指定角色"}),n.value="未指定角色";else s==="autoRefuse"?n.value="系统自动拒绝":(e.push({id:o,name:t,message:"未知错误"}),n.value=t);d==="assign"&&(!c||c.length===0)&&e.push({id:o,name:t,message:"未指定审批人为空时的处理人"}),e.length>0?p.value[o]=e:delete p.value[o]}),(e,o)=>{const t=j;return E(),A(Z,U(e.$attrs,{icon:"Stamp",color:"linear-gradient(89.96deg, #FA6F32 .05%, #FB9337 79.83%)",node:e.node}),{default:f(()=>[r(t,null,{default:f(()=>[I(R($(n)),1)]),_:1})]),_:1},16,["node"])}}}),He=u=>(pe("data-v-b117d3ca"),u=u(),fe(),u),Je={class:"node-box"},Ke=He(()=>P("div",{class:"end-node-circle"},null,-1)),Qe=D({__name:"EndNode",props:{node:{},readOnly:{type:Boolean,default:!1}},emits:["activeNode"],setup(u,{emit:p}){const i=F("flowDesign",{readOnly:g(!1)}),n=p,e=u,o=J(()=>{var s;return((s=i.readOnly)==null?void 0:s.value)||e.readOnly}),t=()=>{o.value||n("activeNode",e.node)};return(s,d)=>{const c=j;return E(),L("div",Je,[Ke,P("div",{class:"end-node",onClick:t},[r(c,null,{default:f(()=>[I(R(s.node.name),1)]),_:1})])])}}}),Ze=Y(Qe,[["__scopeId","data-v-b117d3ca"]]),xe=D({__name:"CcNode",props:{node:{}},setup(u){const p=u,{fields:i,nodesError:n}=F("flowDesign",{fields:g([]),nodesError:g({})}),e=g("");return Q(()=>{var k,B;const o=[],{id:t,assigneeType:s,name:d,users:c,roles:_,leader:b,choice:C,formUser:w,formRole:S,orgLeader:v}=p.node;if(s==="user")if(c.length>0){const O=c.map(y=>se(y));Promise.all(O).then(y=>{e.value=y.map(N=>N.data.name).join("、")})}else o.push({id:t,name:d,message:"未指定人员"}),e.value="未指定人员";else if(s==="choice")e.value=`发起人自选（${C?"多选":"单选"}）`;else if(s==="self")e.value="发起人自己";else if(s==="leader")e.value=b===1?"直属上级":`${b}级上级`;else if(s==="orgLeader")e.value=v===1?"直属主管":`${v}级主管`;else if(s==="formUser"){w||o.push({id:t,name:d,message:"未指定表单内人员"});const O=((k=i.value.find(y=>y.id===w))==null?void 0:k.label)||w||"?";e.value=`表单内（${O}）人员`}else if(s==="formRole"){S||o.push({id:t,name:d,message:"未指定表单内角色"});const O=((B=i.value.find(y=>y.id===S))==null?void 0:B.label)||S||"?";e.value=`表单内（${O}）角色`}else if(s==="role")if(_.length>0){const O=_.map(y=>te(y));Promise.all(O).then(y=>{e.value=y.map(N=>N.data.name).join("、")})}else o.push({id:t,name:d,message:"未指定角色"}),e.value="未指定角色";else o.push({id:t,name:d,message:"未知错误"}),e.value=d;o.length>0?n.value[t]=o:delete n.value[t]}),(o,t)=>{const s=j;return E(),A(Z,U(o.$attrs,{icon:"el:Promotion",color:"rgb(50, 150, 250)",node:o.node}),{default:f(()=>[r(s,null,{default:f(()=>[I(R($(e)),1)]),_:1})]),_:1},16,["node"])}}}),eo=D({__name:"TimerNode",props:{node:{}},setup(u){const p=u,{nodesError:i}=F("flowDesign",{nodesError:g({})}),n=g(""),e={"PT%sS":"秒","PT%sM":"分钟","PT%sH":"小时","P%sD":"天","P%sW":"周","P%sM":"月"};return Q(()=>{const o=[],{id:t,name:s,waitType:d,unit:c,duration:_,timeDate:b}=p.node;d==="date"?(n.value=`等至 ${b||"?"}`,b||o.push({id:t,name:s,message:"未设置等待时间"})):d==="duration"&&(n.value=`等待 ${_} ${e[c]}`,_<=0&&o.push({id:t,name:s,message:"未设置等待时长"})),o.length>0?i.value[t]=o:delete i.value[t]}),(o,t)=>{const s=j;return E(),A(Z,U(o.$attrs,{icon:"Timer",color:"#E872B7",node:o.node}),{default:f(()=>[r(s,null,{default:f(()=>[I(R($(n)),1)]),_:1})]),_:1},16,["node"])}}}),oo=D({__name:"NotifyNode",props:{node:{}},setup(u){const p=u,{fields:i,nodesError:n}=F("flowDesign",{fields:g([]),nodesError:g({})}),e=g("");return Q(()=>{var O,y;const o=[],{id:t,assigneeType:s,name:d,users:c,roles:_,leader:b,choice:C,formUser:w,formRole:S,orgLeader:v,subject:k,types:B}=p.node;if(s==="user")if(c.length>0){const N=c.map(T=>se(T));Promise.all(N).then(T=>{e.value=T.map(V=>V.data.name).join("、")})}else o.push({id:t,name:d,message:"未指定人员"}),e.value="未指定人员";else if(s==="choice")e.value=`发起人自选（${C?"多选":"单选"}）`;else if(s==="self")e.value="发起人自己";else if(s==="leader")e.value=b===1?"直属上级":`${b}级上级`;else if(s==="orgLeader")e.value=v===1?"直属主管":`${v}级主管`;else if(s==="formUser"){w||o.push({id:t,name:d,message:"未指定表单内人员"});const N=((O=i.value.find(T=>T.id===w))==null?void 0:O.label)||w||"?";e.value=`表单内（${N}）人员`}else if(s==="formRole"){S||o.push({id:t,name:d,message:"未指定表单内角色"});const N=((y=i.value.find(T=>T.id===S))==null?void 0:y.label)||S||"?";e.value=`表单内（${N}）角色`}else if(s==="role")if(_.length>0){const N=_.map(T=>te(T));Promise.all(N).then(T=>{e.value=T.map(V=>V.data.name).join("、")})}else o.push({id:t,name:d,message:"未指定角色"}),e.value="未指定角色";else o.push({id:t,name:d,message:"未知错误"}),e.value=d;B.length===0&&o.push({id:t,name:d,message:"未指定通知类型"}),k||o.push({id:t,name:d,message:"消息主题为空"}),p.node.content||o.push({id:t,name:d,message:"消息内容为空"}),o.length>0?n.value[t]=o:delete n.value[t]}),(o,t)=>{const s=j;return E(),A(Z,U(o.$attrs,{icon:"el:BellFilled",color:"#95d475",node:o.node}),{default:f(()=>[r(s,null,{default:f(()=>[I(R($(e)),1)]),_:1})]),_:1},16,["node"])}}}),oe=u=>(pe("data-v-b914766d"),u=u(),fe(),u),no={class:"gateway-node"},so={class:"add-branch"},to=oe(()=>P("div",{class:"top-left-border"},null,-1)),lo=oe(()=>P("div",{class:"bottom-left-border"},null,-1)),ao=oe(()=>P("div",{class:"top-right-border"},null,-1)),ro=oe(()=>P("div",{class:"bottom-right-border"},null,-1)),io=["onClick"],co=["onClick"],uo=D({__name:"GatewayNode",props:{node:{}},emits:["addNode"],setup(u,{emit:p}){const i=p,n=u,{readOnly:e}=F("flowDesign",{readOnly:g(!1)}),o=(d,c)=>{i("addNode",d,c||n.node)},t=d=>{const c=n.node.children[d];n.node.children.splice(d,1),n.node.children.splice(d+1,0,c)},s=d=>{const c=n.node.children[d];n.node.children.splice(d,1),n.node.children.splice(d-1,0,c)};return(d,c)=>{const _=le;return E(),L(q,null,[P("div",no,[P("div",so,[K(d.$slots,"default",{addNode:o,readOnly:$(e)},void 0,!0)]),(E(!0),L(q,null,de(d.node.children,(b,C)=>(E(),L("div",{key:b.id,class:"col-box"},[C===0?(E(),L(q,{key:0},[to,lo],64)):d.node.children.length===C+1?(E(),L(q,{key:1},[ao,ro],64)):ae("",!0),r(he,U({node:b,ref_for:!0},d.$attrs,{onAddNode:o,class:"col-node"}),{append:f(()=>[H(P("div",{class:"move-left",onClick:G(w=>s(C),["stop"])},[r(_,{name:"ArrowLeft"})],8,io),[[x,C!==0&&d.node.children.length!==C+1&&!$(e)]]),H(P("div",{class:"move-right",onClick:G(w=>t(C),["stop"])},[r(_,{name:"ArrowRight"})],8,co),[[x,![C+1,C+2].includes(d.node.children.length)&&!$(e)]])]),_:2},1040,["node"])]))),128))]),r(ve,{onAddNode:o,class:"branch-but"})],64)}}}),po=Y(uo,[["__scopeId","data-v-b914766d"]]),fo=D({__name:"ExclusiveNode",props:{node:{}},setup(u){return(p,i)=>{const n=ee;return E(),A(po,U(p.$attrs,{node:p.node}),{default:f(({addNode:e,readOnly:o})=>[r(n,{type:"primary",disabled:o,onClick:t=>e("condition",p.node),plain:"",round:""},{default:f(()=>[I(" 添加条件 ")]),_:2},1032,["disabled","onClick"])]),_:1},16,["node"])}}}),mo={class:"branch-node"},_o=D({__name:"ConditionNode",props:{node:{}},setup(u){const p=u,{nodesError:i}=F("flowDesign",{nodesError:g({})}),n=g("");return Q(()=>{var _,b;const e=[],{id:o,name:t,def:s,conditions:d,child:c}=p.node;if(s)n.value="不满足其他条件，进入此分支";else if(d.conditions.length>0||(((_=d.groups)==null?void 0:_.length)||0)>0){const C=d.conditions.length+(((b=d.groups)==null?void 0:b.length)||0);n.value=`已设置（${C}）个条件`,c||e.push({id:o,name:t,message:"分支下节点为空"})}else e.push({id:o,name:t,message:"未设置条件"}),n.value="未设置条件";e.length>0?i.value[o]=e:delete i.value[o]}),(e,o)=>{const t=j,s=Z;return E(),L("div",mo,[r(s,U(e.$attrs,{icon:"Share",node:e.node,readOnly:e.node.def}),{default:f(()=>[r(t,null,{default:f(()=>[I(R($(n)),1)]),_:1}),K(e.$slots,"append",{},void 0,!0)]),_:3},16,["node","readOnly"])])}}}),vo=Y(_o,[["__scopeId","data-v-898e74c1"]]),ho=D({name:"TreeNode"}),he=D({...ho,props:{node:{}},setup(u){const p={start:Ge,approval:qe,cc:xe,timer:eo,notify:oo,exclusive:fo,condition:vo,end:Ze};return(i,n)=>{const e=z("TreeNode",!0);return E(),L(q,null,[K(i.$slots,"default"),(E(),A(ie(p[i.node.type]),U({node:i.node},i.$attrs),De({_:2},[de(i.$slots,(o,t)=>({name:t,fn:f(s=>[K(i.$slots,t,Ie(Be(s||{})))])}))]),1040,["node"])),i.node.child?(E(),A(e,U({key:0,node:i.node.child},i.$attrs),null,16,["node"])):ae("",!0)],64)}}});function go(u){const p=g(!1);let i,n,e,o;const t=c=>{u.value&&(p.value=!0,i=c.pageX,n=c.pageY,e=u.value.scrollLeft,o=u.value.scrollTop,document.addEventListener("mousemove",s),document.addEventListener("mouseup",d))},s=c=>{if(!p.value||!u.value)return;const _=c.pageX-i,b=c.pageY-n;u.value.scrollLeft=e-_,u.value.scrollTop=o-b},d=()=>{p.value=!1,document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",d)};return me(()=>{var c;(c=u.value)==null||c.addEventListener("mousedown",t)}),_e(()=>{var c;(c=u.value)==null||c.removeEventListener("mousedown",t)}),{isDragging:p}}const yo=(u,p)=>{const i=e=>{e.ctrlKey&&(e.preventDefault(),u(e))},n=e=>{e.key==="Control"&&p()};me(()=>{window.addEventListener("wheel",i,{passive:!1}),window.addEventListener("keyup",n)}),_e(()=>{window.removeEventListener("wheel",i),window.removeEventListener("keyup",n)})},$o={START:"start",APPROVAL:"approval",CC:"cc",EXCLUSIVE:"exclusive",TIMER:"timer",NOTIFY:"notify",CONDITION:"condition",END:"end"},bo={class:"zoom"},No={class:"node-container"},Eo=D({__name:"index",props:{process:{},fields:{},readOnly:{type:Boolean,default:!1},defaultZoom:{default:100},bgColor:{default:"var(--el-bg-color-page)"}},setup(u){re(l=>({"646e1203":l.bgColor,"18fc304f":$(t)}));const p=u,i=g(!0),n=g(100),e=g({id:"",name:"",type:$o.START}),o=g(!1),t=J(()=>n.value/100),s=J(()=>p.readOnly);yo(l=>{if(i.value=!1,l.deltaY<0){if(n.value>=170)return;n.value+=10}else{if(n.value<=50)return;n.value-=10}},()=>{console.log("end"),i.value=!0});const _=g({}),b=J(()=>{const l=[],a=m=>{m.forEach(h=>{h.type==="formItem"&&l.push(h),Array.isArray(h.children)&&a(h.children)})};return a(p.fields),l});Me("flowDesign",{readOnly:s,fields:b,nodesError:_});const C=g(null);go(C);const w=()=>{let l=`node_${Math.random().toString(36).substring(2,7)}`;const a=(m,h)=>{if(m.id===h)return!0;if(m.child)return a(m.child,h);if("children"in m){const M=m;if(M.children&&M.children.length>0)return M.children.some(W=>a(W,h))}return!1};return a(p.process,l)?w():l},S=l=>{const a=l.child,m=w();l.child={id:m,pid:l.id,type:"approval",name:"审批人",executionListeners:[],child:a,assigneeType:"user",formUser:"",formRole:"",users:[],roles:[],leader:1,orgLeader:1,choice:!1,self:!1,multi:"sequential",multiPercent:100,nobody:"pass",nobodyUsers:[],formProperties:[],operations:{complete:!0,refuse:!0,back:!0,transfer:!0,delegate:!0,addMulti:!1,minusMulti:!1}},a&&(a.pid=m)},v=l=>{const a=l.child,m=w();l.child={id:m,pid:l.id,name:"消息通知",type:"notify",child:a,assigneeType:"user",formUser:"",formRole:"",users:[],roles:[],leader:1,orgLeader:1,choice:!1,self:!1,types:["site"],subject:"",content:""},a&&(a.pid=m)},k=l=>{const a=l.child,m=w();l.child={id:m,pid:l.id,name:"计时等待",type:"timer",child:a,waitType:"duration",unit:"PT%sS",duration:0,timeDate:void 0},a&&(a.pid=m)},B=l=>{const a=l.child,m=w();l.child={id:m,pid:l.id,type:"cc",name:"抄送人",child:a,assigneeType:"user",formUser:"",formRole:"",users:[],roles:[],leader:1,orgLeader:1,choice:!1,self:!1,formProperties:[]},a&&(a.pid=m)},O=l=>{const a=l;a.children.splice(a.children.length-1,0,{id:w(),pid:a.id,type:"condition",def:!1,name:`条件${a.children.length+1}`,conditions:{operator:"and",conditions:[],groups:[]},child:void 0})},y=l=>{const a=l.child,m=w(),h={id:m,pid:l.id,type:"exclusive",name:"独占网关",child:a,children:[]};if(a&&(a.pid=m),O(h),O(h),l.child=h,h.children.length>0){const M=h.children[h.children.length-1];M.def=!0,M.name="默认条件"}},N=(l,a)=>{const h={exclusive:y,condition:O,cc:B,timer:k,notify:v,approval:S}[l];h&&h(a)},T=l=>{delete _.value[l.id],V(p.process,l)},V=(l,a)=>{var m;if(delete _.value[a.id],l.id===a.pid)if("children"in l&&((m=l.child)==null?void 0:m.id)!==a.id){const h=l,M=h.children.findIndex(W=>W.id===a.id);M!==-1&&(h.children.length<=2?(X(h),T(h)):(X(a),h.children.splice(M,1)))}else a.child&&a.child.pid&&(a.child.pid=l.id),l.child=a.child;else if(l.child&&V(l.child,a),"children"in l){const h=l;h.children&&h.children.length>0&&h.children.forEach(M=>{V(M,a)})}},X=l=>{if(delete _.value[l.id],l.child&&X(l.child),"children"in l){const a=l;a.children&&a.children.length>0&&a.children.forEach(m=>{X(m)})}},ne=l=>{e.value=l,o.value=!0};return(l,a)=>{const m=ee,h=ue,M=ge;return E(),L("div",{class:ce(["designer-container cursor-default active:cursor-grabbing",{"cursor-grabbing":!$(i)}]),ref_key:"designerContainerRef",ref:C},[P("div",bo,[r(h,{content:l.$t("flow.tool.zoomIn"),placement:"bottom-start"},{default:f(()=>[r(m,{icon:"plus",onClick:a[0]||(a[0]=W=>n.value+=10),disabled:$(n)>=170,circle:""},null,8,["disabled"])]),_:1},8,["content"]),P("span",null,R($(n))+"%",1),r(h,{content:l.$t("flow.tool.zoomOut"),placement:"bottom-start"},{default:f(()=>[r(m,{icon:"minus",onClick:a[1]||(a[1]=W=>n.value-=10),circle:"",disabled:$(n)<=50},null,8,["disabled"])]),_:1},8,["content"])]),P("div",No,[r(he,{node:l.process,onAddNode:N,onDelNode:T,onActiveNode:ne},null,8,["node"])]),r(M,{modelValue:$(o),"onUpdate:modelValue":a[2]||(a[2]=W=>Ae(o)?o.value=W:null),"active-data":$(e)},null,8,["modelValue","active-data"])],2)}}}),Co=Y(Eo,[["__scopeId","data-v-38a4efd0"]]),wo={class:"h-90vh"},Oo=D({__name:"index",setup(u){const{fields:p,process:i}=Re(),{readOnly:n}=Ue();return(e,o)=>(E(),L("div",wo,[r($(Co),{process:$(i),readOnly:$(n),fields:$(p)},null,8,["process","readOnly","fields"])]))}});export{Oo as default};
